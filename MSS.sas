libname tmp1 'C:\Users\pws5\OneDrive - University of Pittsburgh\Desktop\';run;
***FOR MSS CALCULATIONS***
*Create ETHNicity indicator
Insert the Name for the NHANES data
being Input after "set";
data preMSS; set tmp1.Merged1718;
IF(RIDRETH1<3) then ETHN=1;
IF(RIDRETH1=3) then ETHN=2;
IF(RIDRETH1=4) then ETHN=3;
IF (RIDRETH3=6) then ETHN=4;
BMI_Z_SCORE=BMXBMI;
run;
proc sort data=preMSS;
by RIDAGEYR; run;
*BEST GUESS FOR ADOLESCENTS IS THAT BMI Z-SCORE IS RELATIVE TO AGE,
OF COURSE I AM BASING AGE-WISE MEAN AND SD FOR Z FROM THIS SAMPLE ONLY;
proc standard data=preMSS mean=0 std=1 out=MSS; 
by RIDAGEYR;
var BMI_Z_SCORE;
run;

*Here's the calculator for MSS;
data MSS; set MSS;
*ADULT,HISPANIC,MALE;
IF (RIDAGEYR>=20 & ETHN=1 & RIAGENDR=1) then
METS_Z_BMI=-4.8198 + 0.0355 * BMXBMI - 0.0303 * LBDHDD + 0.0051 * SBP + 0.7835 * LOG(LBXSTR) + 0.0104 * LBXSGL;
*ADULT,WHITE,MALE;
IF (RIDAGEYR>=20 & ETHN=2 & RIAGENDR=1) then
METS_Z_BMI=-4.8316 + 0.0315 * BMXBMI - 0.0272 * LBDHDD + 0.0044 * SBP + 0.8018 * LOG(LBXSTR) + 0.0101*LBXSGL;
*ADULT, BLACK,MALE;
IF  (RIDAGEYR>=20  &  RIAGENDR=1 & ETHN=3) then
METS_Z_BMI = -4.8134 + 0.0460*BMXBMI - 0.0233*LBDHDD + 0.0020*SBP + 0.5983*LOG(LBXSTR) + 0.0166*LBXSGL;
*ADULT, HISPANIC,FEMALE;
IF  (RIDAGEYR>=20  &  RIAGENDR=2 & ETHN=1) then
METS_Z_BMI = -7.1844 + 0.0333*BMXBMI - 0.0166*LBDHDD + 0.0085*SBP + 0.8625*LOG(LBXSTR) + 0.0221*LBXSGL;
*ADULT, WHITE,FEMALE;
IF  (RIDAGEYR>=20  &  RIAGENDR=2 & ETHN=2) then
METS_Z_BMI = -6.5231 + 0.0523*BMXBMI - 0.0138*LBDHDD + 0.0081*SBP + 0.6125*LOG(LBXSTR) + 0.0208*LBXSGL;
*ADULT BLACK FEMALE;
IF  (RIDAGEYR>=20  &  RIAGENDR=2 & ETHN=3) then
METS_Z_BMI = -6.7982 + 0.0484*BMXBMI - 0.0108*LBDHDD + 0.0073*SBP + 0.5278*LOG(LBXSTR) + 0.0281*LBXSGL;
*YOUTH HISPANIC MALE;
IF  (RIDAGEYR<20  &  RIAGENDR=1 & ETHN=1) then 
METS_Z_BMI = -3.2971 + 0.2930*BMI_Z_SCORE - 0.0315*LBDHDD + 0.0109*SBP + 0.6137*LOG(LBXSTR) + 0.0095*LBXSGL;
*YOUTH WHITE MALE;
IF  (RIDAGEYR<20  &  RIAGENDR=1 & ETHN=2) then
METS_Z_BMI = -4.931 + 0.2804*BMI_Z_SCORE - 0.0257*LBDHDD + 0.0189*SBP + 0.6240*LOG(LBXSTR) + 0.0140*LBXSGL;
*YOUTH BLACK MALE;
IF  (RIDAGEYR<20  &  RIAGENDR=1 & ETHN=3) then
METS_Z_BMI = -4.7544 + 0.2401*BMI_Z_SCORE - 0.0284*LBDHDD + 0.0134*SBP + 0.6773*LOG(LBXSTR) + 0.0179*LBXSGL;
*YOUTH HISPANIC FEMALE;
IF  (RIDAGEYR<20  &  RIAGENDR=2 & ETHN=1) then
METS_Z_BMI = -4.7637 + 0.3520*BMI_Z_SCORE - 0.0263*LBDHDD + 0.0152*SBP + 0.6910*LOG(LBXSTR) + 0.0133*LBXSGL;
*YOUTH WHITE FEMALE;
IF  (RIDAGEYR<20  &  RIAGENDR=2 & ETHN=2) then
METS_Z_BMI = -4.3757 + 0.4849*BMI_Z_SCORE - 0.0176*LBDHDD + 0.0257*SBP + 0.3172*LOG(LBXSTR) + 0.0083*LBXSGL;
*YOUTH BLACK FEMALE;
IF  (RIDAGEYR<20  &  RIAGENDR=2 & ETHN=3) then
METS_Z_BMI = -3.7145 + 0.5136*BMI_Z_SCORE - 0.0190*LBDHDD + 0.0131*SBP + 0.4442*LOG(LBXSTR) + 0.0108*LBXSGL;
*FOR WAIST COMPUTATION, SAME FORMULA FOR MALES AND FEMALES;
*ADULT,HISPANIC;
IF (RIDAGEYR>=20 & ETHN=1) then
METS_Z_WC=-7.7641 + 0.0162*BMXWAIST - 0.0157*LBDHDD + 0.0084*SBP + 0.8872*LOG(LBXSTR) + 0.0206*LBXSGL;
*ADULT,WHITE;
IF (RIDAGEYR>=20 & ETHN=2 )then
METS_Z_WC=-7.2591 + 0.0254*BMXWAIST - 0.0120*LBDHDD + 0.0075*SBP + 0.5800*LOG(LBXSTR) + 0.0203*LBXSGL;
*ADULT,BLACK;
IF  (RIDAGEYR>=20 & ETHN=3) then
METS_Z_WC=-7.1913 + 0.0304*BMXWAIST - 0.0095*LBDHDD + 0.0054*SBP + 0.4455*LOG(LBXSTR) + 0.0225*LBXSGL;
*ADULT,ASIAN, MALE;
IF  (RIDAGEYR>=20 & ETHN=4 & RIAGENDR=1) then
METS_Z_WC=-8.5245 + 0.0371*BMXWAIST - 0.0182*LBDHDD + 0.0089*SBP + 0.7913*LOG(LBXSTR) + 0.0156*LBXSGL;
*ADULT,ASIAN, FEMALE;
IF  (RIDAGEYR>=20 & ETHN=4 & RIAGENDR=2) then
METS_Z_WC=-8.448 + 0.0403*BMXWAIST - 0.0155*LBDHDD + 0.0115*SBP + 0.6704*LOG(LBXSTR) + 0.0223*LBXSGL;
run;

